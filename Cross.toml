# Cross.toml
# Configuration for cross-compiling umadb

# -----------------------------
# Linux GNU targets
# -----------------------------
[target.x86_64-unknown-linux-gnu]
image = "ghcr.io/cross-rs/x86_64-unknown-linux-gnu:latest"
pre-build = [
    'apt-get update && apt-get install -y unzip',
    'curl -LO "https://github.com/protocolbuffers/protobuf/releases/download/v33.1/protoc-33.1-linux-x86_64.zip" && unzip protoc-33.1-linux-x86_64.zip -d /usr/ && chmod 755 /usr/bin/protoc',
]

[target.aarch64-unknown-linux-gnu]
image = "ghcr.io/cross-rs/aarch64-unknown-linux-gnu:latest"
pre-build = [
    "apt-get update && apt-get install -y protobuf-compiler",
]

# -----------------------------
# Linux MUSL targets
# -----------------------------
[target.x86_64-unknown-linux-musl]
image = "ghcr.io/cross-rs/x86_64-unknown-linux-musl"
pre-build = [
    'apt-get update && apt-get install -y unzip',
    'curl -LO "https://github.com/protocolbuffers/protobuf/releases/download/v33.1/protoc-33.1-linux-x86_64.zip" && unzip protoc-33.1-linux-x86_64.zip -d /usr/ && chmod 755 /usr/bin/protoc',
]

[target.aarch64-unknown-linux-musl]
image = "ghcr.io/cross-rs/aarch64-unknown-linux-musl"
pre-build = [
    "apt-get update && apt-get install -y protobuf-compiler",
]

# -----------------------------
# macOS targets
# -----------------------------
# These are built natively, so no Docker needed.
[target.x86_64-apple-darwin]
# no image needed, cross ignores Docker for macOS
[target.aarch64-apple-darwin]
# no image needed
